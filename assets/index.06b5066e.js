var A=Object.defineProperty,C=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var f=(n,a,l)=>a in n?A(n,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[a]=l,E=(n,a)=>{for(var l in a||(a={}))F.call(a,l)&&f(n,l,a[l]);if(N)for(var l of N(a))B.call(a,l)&&f(n,l,a[l]);return n},g=(n,a)=>C(n,z(a));import{R as t,j as d,L as k,O as H,r as i,N as M,u as L,a as O,b as m,c as R,d as y,e as P,B as q}from"./vendor.79c50e32.js";const D=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))e(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&e(p)}).observe(document,{childList:!0,subtree:!0});function l(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerpolicy&&(o.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?o.credentials="include":c.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(c){if(c.ep)return;c.ep=!0;const o=l(c);fetch(c.href,o)}};D();function J(n={}){const{wrapper:a}=n.components||{};return a?t.createElement(a,n,t.createElement(l)):l();function l(){const e=Object.assign({p:"p",ol:"ol",li:"li",code:"code",strong:"strong",h2:"h2",a:"a",pre:"pre",span:"span",em:"em",div:"div"},n.components);return t.createElement(t.Fragment,null,t.createElement(e.p,null,"There are many articles written about React performance optimizations. In general, if some state update is slow, you need to:"),`
`,t.createElement(e.ol,null,`
`,t.createElement(e.li,null,"Verify you're running a production build. (Development builds are intentionally slower, in extreme cases even by an order of magnitude.)"),`
`,t.createElement(e.li,null,"Verify that you didn't put the state higher in the tree than necessary. (For example, putting input state in a centralized store might not be the best idea.)"),`
`,t.createElement(e.li,null,"Run React DevTools Profiler to see what gets re-rendered, and wrap the most expensive subtrees with ",t.createElement(e.code,null,"memo()"),". (And add ",t.createElement(e.code,null,"useMemo()")," where needed.)"),`
`),`
`,t.createElement(e.p,null,"This last step is annoying, especially for components in between, and ideally a compiler would do it for you. In the future, it might."),`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"In this post, I want to share two different techniques.")," They're surprisingly basic, which is why people rarely realize they improve rendering performance."),`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"These techniques are complementary to what you already know!")," They don't replace ",t.createElement(e.code,null,"memo")," or ",t.createElement(e.code,null,"useMemo"),", but they're often good to try first."),`
`,t.createElement(e.h2,{id:"an-artificially-slow-component"},t.createElement(e.a,{className:"header-anchor",href:"#an-artificially-slow-component"},"#"),"An (Artificially) Slow Component"),`
`,t.createElement(e.p,null,"Here's a component with a severe rendering performance problem:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx"},t.createElement(e.span,{className:"token keyword module"},"import")," ",t.createElement(e.span,{className:"token imports"},t.createElement(e.span,{className:"token punctuation"},"{")," useState ",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token keyword module"},"from")," ",t.createElement(e.span,{className:"token string"},"'react'"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword module"},"export")," ",t.createElement(e.span,{className:"token keyword module"},"default")," ",t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"App")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"["),"color",t.createElement(e.span,{className:"token punctuation"},",")," setColor",t.createElement(e.span,{className:"token punctuation"},"]")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"useState"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token string"},"'red'"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
  `,t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
    `,t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},`
      `),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"input")," ",t.createElement(e.span,{className:"token attr-name"},"value"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),"color",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token attr-name"},"onChange"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"e"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token arrow operator"},"=>")," ",t.createElement(e.span,{className:"token function"},"setColor"),t.createElement(e.span,{className:"token punctuation"},"("),"e",t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"target"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"value"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"},`
      `),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p")," ",t.createElement(e.span,{className:"token attr-name"},"style"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"{")," color ",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"Hello, world!"),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},`
      `),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ExpensiveTree"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"},`
    `),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),`
  `,t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`

`,t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"ExpensiveTree")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token keyword"},"let")," now ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token dom variable"},"performance"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token method function property-access"},"now"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
  `,t.createElement(e.span,{className:"token keyword control-flow"},"while")," ",t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token dom variable"},"performance"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token method function property-access"},"now"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token operator"},"-")," now ",t.createElement(e.span,{className:"token operator"},"<")," ",t.createElement(e.span,{className:"token number"},"100"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// Artificial delay -- do nothing for 100ms"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),`
  `,t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"I am a very slow component tree."),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,t.createElement(e.em,null,"(",t.createElement(e.a,{href:"https://codesandbox.io/s/frosty-glade-m33km?file=/src/App.js:23-513"},"Try it here"),")")),`
`,t.createElement(e.p,null,"The problem is that whenever ",t.createElement(e.code,null,"color")," changes inside ",t.createElement(e.code,null,"App"),", we will re-render ",t.createElement(e.code,null,"<ExpensiveTree />")," which we've artificially delayed to be very slow."),`
`,t.createElement(e.p,null,"I could ",t.createElement(e.a,{href:"https://codesandbox.io/s/amazing-shtern-61tu4?file=/src/App.js"},"put ",t.createElement(e.code,null,"memo()")," on it")," and call it a day, but there are many existing articles about it so I won't spend time on it. I want to show two different solutions."),`
`,t.createElement(e.h2,{id:"solution-1-move-state-down"},t.createElement(e.a,{className:"header-anchor",href:"#solution-1-move-state-down"},"#"),"Solution 1: Move State Down"),`
`,t.createElement(e.p,null,"If you look at the rendering code closer, you'll notice only a part of the returned tree actually cares about the current ",t.createElement(e.code,null,"color"),":"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx{2,5-6}"},t.createElement(e.span,{className:"token keyword module"},"export")," ",t.createElement(e.span,{className:"token keyword module"},"default")," ",t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"App")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`,t.createElement(e.div,{className:"mdx-marker"},"  ",t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"["),"color",t.createElement(e.span,{className:"token punctuation"},",")," setColor",t.createElement(e.span,{className:"token punctuation"},"]")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"useState"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token string"},"'red'"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`),"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"input")," ",t.createElement(e.span,{className:"token attr-name"},"value"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),"color",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token attr-name"},"onChange"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"e"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token arrow operator"},"=>")," ",t.createElement(e.span,{className:"token function"},"setColor"),t.createElement(e.span,{className:"token punctuation"},"("),"e",t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"target"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"value"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p")," ",t.createElement(e.span,{className:"token attr-name"},"style"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"{")," color ",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"Hello, world!"),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ExpensiveTree"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,"So let's extract that part into a ",t.createElement(e.code,null,"Form")," component and move state ",t.createElement(e.em,null,"down")," into it:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx{4,11,14,15}"},t.createElement(e.span,{className:"token keyword module"},"export")," ",t.createElement(e.span,{className:"token keyword module"},"default")," ",t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"App")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`,"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"Form"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ExpensiveTree"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</")),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`,`
`,t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"Form")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`,t.createElement(e.div,{className:"mdx-marker"},"  ",t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"["),"color",t.createElement(e.span,{className:"token punctuation"},",")," setColor",t.createElement(e.span,{className:"token punctuation"},"]")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"useState"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token string"},"'red'"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`),"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"input")," ",t.createElement(e.span,{className:"token attr-name"},"value"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),"color",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token attr-name"},"onChange"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"e"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token arrow operator"},"=>")," ",t.createElement(e.span,{className:"token function"},"setColor"),t.createElement(e.span,{className:"token punctuation"},"("),"e",t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"target"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"value"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p")," ",t.createElement(e.span,{className:"token attr-name"},"style"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"{")," color ",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"Hello, world!"),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</")),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,t.createElement(e.em,null,"(",t.createElement(e.a,{href:"https://codesandbox.io/s/billowing-wood-1tq2u?file=/src/App.js:64-380"},"Try it here"),")")),`
`,t.createElement(e.p,null,"Now if the ",t.createElement(e.code,null,"color")," changes, only the ",t.createElement(e.code,null,"Form")," re-renders. Problem solved."),`
`,t.createElement(e.h2,{id:"solution-2-lift-content-up"},t.createElement(e.a,{className:"header-anchor",href:"#solution-2-lift-content-up"},"#"),"Solution 2: Lift Content Up"),`
`,t.createElement(e.p,null,"The above solution doesn't work if the piece of state is used somewhere ",t.createElement(e.em,null,"above")," the expensive tree. For example, let's say we put the ",t.createElement(e.code,null,"color")," on the ",t.createElement(e.em,null,"parent")," ",t.createElement(e.code,null,"<div>"),":"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx{2,4}"},t.createElement(e.span,{className:"token keyword module"},"export")," ",t.createElement(e.span,{className:"token keyword module"},"default")," ",t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"App")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`,t.createElement(e.div,{className:"mdx-marker"},"  ",t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"["),"color",t.createElement(e.span,{className:"token punctuation"},",")," setColor",t.createElement(e.span,{className:"token punctuation"},"]")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"useState"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token string"},"'red'"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`),"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,t.createElement(e.div,{className:"mdx-marker"},"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"div")," ",t.createElement(e.span,{className:"token attr-name"},"style"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"{")," color ",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"input")," ",t.createElement(e.span,{className:"token attr-name"},"value"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),"color",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token attr-name"},"onChange"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"e"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token arrow operator"},"=>")," ",t.createElement(e.span,{className:"token function"},"setColor"),t.createElement(e.span,{className:"token punctuation"},"("),"e",t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"target"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"value"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"Hello, world!"),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ExpensiveTree"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,t.createElement(e.em,null,"(",t.createElement(e.a,{href:"https://codesandbox.io/s/bold-dust-0jbg7?file=/src/App.js:58-313"},"Try it here"),")")),`
`,t.createElement(e.p,null,`Now it seems like we can't just "extract" the parts that don't use `,t.createElement(e.code,null,"color")," into another component, since that would include the parent ",t.createElement(e.code,null,"<div>"),", which would then include ",t.createElement(e.code,null,"<ExpensiveTree />"),". Can't avoid ",t.createElement(e.code,null,"memo")," this time, right?"),`
`,t.createElement(e.p,null,"Or can we?"),`
`,t.createElement(e.p,null,"Play with this sandbox and see if you can figure it out."),`
`,t.createElement(e.p,null,"..."),`
`,t.createElement(e.p,null,"..."),`
`,t.createElement(e.p,null,"..."),`
`,t.createElement(e.p,null,"The answer is remarkably plain:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx{4,5,10,15}"},t.createElement(e.span,{className:"token keyword module"},"export")," ",t.createElement(e.span,{className:"token keyword module"},"default")," ",t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"App")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`,"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ColorPicker")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"},"Hello, world!"),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"p"),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),t.createElement(e.span,{className:"token class-name"},"ExpensiveTree"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),t.createElement(e.span,{className:"token class-name"},"ColorPicker")),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`,`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"ColorPicker")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token punctuation"},"{")," children ",t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
`),"  ",t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"["),"color",t.createElement(e.span,{className:"token punctuation"},",")," setColor",t.createElement(e.span,{className:"token punctuation"},"]")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"useState"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token string"},'"red"'),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,"  ",t.createElement(e.span,{className:"token keyword control-flow"},"return")," ",t.createElement(e.span,{className:"token punctuation"},"("),`
`,"    ",t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"div")," ",t.createElement(e.span,{className:"token attr-name"},"style"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"{")," color ",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},"}")),t.createElement(e.span,{className:"token punctuation"},">")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"<"),"input")," ",t.createElement(e.span,{className:"token attr-name"},"value"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),"color",t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token attr-name"},"onChange"),t.createElement(e.span,{className:"token script language-javascript"},t.createElement(e.span,{className:"token script-punctuation punctuation"},"="),t.createElement(e.span,{className:"token punctuation"},"{"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"e"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token arrow operator"},"=>")," ",t.createElement(e.span,{className:"token function"},"setColor"),t.createElement(e.span,{className:"token punctuation"},"("),"e",t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"target"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},"value"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"}"))," ",t.createElement(e.span,{className:"token punctuation"},"/>")),t.createElement(e.span,{className:"token plain-text"}),`
`,t.createElement(e.div,{className:"mdx-marker"},t.createElement(e.span,{className:"token plain-text"},"      "),t.createElement(e.span,{className:"token punctuation"},"{"),"children",t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token plain-text"}),`
`),t.createElement(e.span,{className:"token plain-text"},"    "),t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token tag"},t.createElement(e.span,{className:"token punctuation"},"</"),"div"),t.createElement(e.span,{className:"token punctuation"},">")),`
`,"  ",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,t.createElement(e.em,null,"(",t.createElement(e.a,{href:"https://codesandbox.io/s/wonderful-banach-tyfr1?file=/src/App.js:58-423"},"Try it here"),")")),`
`,t.createElement(e.p,null,"We split the ",t.createElement(e.code,null,"App")," component in two. The parts that depend on the ",t.createElement(e.code,null,"color"),", together with the ",t.createElement(e.code,null,"color")," state variable itself, have moved into ",t.createElement(e.code,null,"ColorPicker"),"."),`
`,t.createElement(e.p,null,"The parts that don't care about the ",t.createElement(e.code,null,"color")," stayed in the ",t.createElement(e.code,null,"App")," component and are passed to ",t.createElement(e.code,null,"ColorPicker")," as JSX content, also known as the ",t.createElement(e.code,null,"children")," prop."),`
`,t.createElement(e.p,null,"When the ",t.createElement(e.code,null,"color")," changes, ",t.createElement(e.code,null,"ColorPicker")," re-renders. But it still has the same ",t.createElement(e.code,null,"children")," prop it got from the ",t.createElement(e.code,null,"App")," last time, so React doesn't visit that subtree."),`
`,t.createElement(e.p,null,"And as a result, ",t.createElement(e.code,null,"<ExpensiveTree />")," doesn't re-render."),`
`,t.createElement(e.h2,{id:"whats-the-moral"},t.createElement(e.a,{className:"header-anchor",href:"#whats-the-moral"},"#"),"What's the moral?"),`
`,t.createElement(e.p,null,"Before you apply optimizations like ",t.createElement(e.code,null,"memo")," or ",t.createElement(e.code,null,"useMemo"),", it might make sense to look if you can split the parts that change from the parts that don't change."),`
`,t.createElement(e.p,null,"The interesting part about these approaches is that ",t.createElement(e.strong,null,"they don't really have anything to do with performance, per se"),". Using the ",t.createElement(e.code,null,"children")," prop to split up components usually makes the data flow of your application easier to follow and reduces the number of props plumbed down through the tree. Improved performance in cases like this is a cherry on top, not the end goal."),`
`,t.createElement(e.p,null,"Curiously, this pattern also unlocks ",t.createElement(e.em,null,"more")," performance benefits in the future."),`
`,t.createElement(e.p,null,"For example, when ",t.createElement(e.a,{href:"https://reactjs.org/blog/2020/12/21/data-fetching-with-react-server-components.html"},"Server Components")," are stable and ready for adoption, our ",t.createElement(e.code,null,"ColorPicker")," component could receive its ",t.createElement(e.code,null,"children")," ",t.createElement(e.a,{href:"https://youtu.be/TQQPAU21ZUw?t=1314"},"from the server"),". Either the whole ",t.createElement(e.code,null,"<ExpensiveTree />"),' component or its parts could run on the server, and even a top-level React state update would "skip over" those parts on the client.'),`
`,t.createElement(e.p,null,"That's something even ",t.createElement(e.code,null,"memo")," couldn't do! But again, both approaches are complementary. Don't neglect moving state down (and lifting content up!)"),`
`,t.createElement(e.p,null,"Then, where it's not enough, use the Profiler and sprinkle those memo\u2019s."),`
`,t.createElement(e.h2,{id:"didnt-i-read-about-this-before"},t.createElement(e.a,{className:"header-anchor",href:"#didnt-i-read-about-this-before"},"#"),"Didn't I read about this before?"),`
`,t.createElement(e.p,null,t.createElement(e.a,{href:"https://kentcdodds.com/blog/optimize-react-re-renders"},"Yes, probably.")),`
`,t.createElement(e.p,null,"This is not a new idea. It's a natural consequence of React composition model. It's simple enough that it's underappreciated, and deserves a bit more love."))}}function W(n={}){const{wrapper:a}=n.components||{};return a?t.createElement(a,n,t.createElement(l)):l();function l(){const e=Object.assign({p:"p",pre:"pre",code:"code",span:"span",em:"em",h2:"h2",a:"a",ul:"ul",li:"li",strong:"strong"},n.components);return t.createElement(t.Fragment,null,t.createElement(e.p,null,"It was a late evening."),`
`,t.createElement(e.p,null,"My colleague has just checked in the code that they've been writing all week. We were working on a graphics editor canvas, and they implemented the ability to resize shapes like rectangles and ovals by dragging small handles at their edges."),`
`,t.createElement(e.p,null,"The code worked."),`
`,t.createElement(e.p,null,"But it was repetitive. Each shape (such as a rectangle or an oval) had a different set of handles, and dragging each handle in different directions affected the shape's position and size in a different way. If the user held Shift, we'd also need to preserve proportions while resizing. There was a bunch of math."),`
`,t.createElement(e.p,null,"The code looked something like this:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx"},t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},"resizeTopLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeTopRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeBottomLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeBottomRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Oval")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},"resizeLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeTop"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeBottom"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Header")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},"resizeLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"TextBlock")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},"resizeTopLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeTopRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeBottomLeft"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"resizeBottomRight"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"position",t.createElement(e.span,{className:"token punctuation"},",")," size",t.createElement(e.span,{className:"token punctuation"},",")," preserveAspect",t.createElement(e.span,{className:"token punctuation"},",")," dx",t.createElement(e.span,{className:"token punctuation"},",")," dy"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 10 repetitive lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},";"),`
`)),`
`,t.createElement(e.p,null,"That repetitive math was really bothering me."),`
`,t.createElement(e.p,null,"It wasn\u2019t ",t.createElement(e.em,null,"clean"),"."),`
`,t.createElement(e.p,null,"Most of the repetition was between similar directions. For example, ",t.createElement(e.code,null,"Oval.resizeLeft()")," had similarities with ",t.createElement(e.code,null,"Header.resizeLeft()"),". This was because they both dealt with dragging the handle on the left side."),`
`,t.createElement(e.p,null,"The other similarity was between the methods for the same shape. For example, ",t.createElement(e.code,null,"Oval.resizeLeft()")," had similarities with the other ",t.createElement(e.code,null,"Oval")," methods. This was because they all dealt with ovals. There was also some duplication between ",t.createElement(e.code,null,"Rectangle"),", ",t.createElement(e.code,null,"Header"),", and ",t.createElement(e.code,null,"TextBlock")," because text blocks ",t.createElement(e.em,null,"were")," rectangles."),`
`,t.createElement(e.p,null,"I had an idea."),`
`,t.createElement(e.p,null,"We could ",t.createElement(e.em,null,"remove all duplication")," by grouping the code like this instead:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx"},t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Directions")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},"top"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"left"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"bottom"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"right"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Shapes")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"Oval")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},t.createElement(e.span,{className:"token spread operator"},"...")),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
    `,t.createElement(e.span,{className:"token comment"},"// 5 unique lines of math"),`
  `,t.createElement(e.span,{className:"token punctuation"},"}"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`
`)),`
`,t.createElement(e.p,null,"and then composing their behaviors:"),`
`,t.createElement(e.pre,{className:"language-jsx"},t.createElement(e.code,{className:"language-jsx"},t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token punctuation"},"{")," top",t.createElement(e.span,{className:"token punctuation"},",")," bottom",t.createElement(e.span,{className:"token punctuation"},",")," left",t.createElement(e.span,{className:"token punctuation"},",")," right ",t.createElement(e.span,{className:"token punctuation"},"}")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Directions"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"directions"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token comment"},"// 20 lines of code"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," fourCorners ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"["),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"top",t.createElement(e.span,{className:"token punctuation"},",")," left",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"top",t.createElement(e.span,{className:"token punctuation"},",")," right",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"bottom",t.createElement(e.span,{className:"token punctuation"},",")," left",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"bottom",t.createElement(e.span,{className:"token punctuation"},",")," right",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token keyword"},"let")," fourSides ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"["),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"top",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"left",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"right",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
  `,t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"bottom",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},","),`
`,t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token keyword"},"let")," twoSides ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token punctuation"},"["),t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"left",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},",")," ",t.createElement(e.span,{className:"token function"},"createHandle"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token punctuation"},"["),"right",t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},"]"),t.createElement(e.span,{className:"token punctuation"},";"),`

`,t.createElement(e.span,{className:"token keyword"},"function")," ",t.createElement(e.span,{className:"token function"},"createBox"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token parameter"},"shape",t.createElement(e.span,{className:"token punctuation"},",")," handles"),t.createElement(e.span,{className:"token punctuation"},")")," ",t.createElement(e.span,{className:"token punctuation"},"{"),`
  `,t.createElement(e.span,{className:"token comment"},"// 20 lines of code"),`
`,t.createElement(e.span,{className:"token punctuation"},"}"),`

`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"createBox"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token maybe-class-name"},"Shapes"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")),t.createElement(e.span,{className:"token punctuation"},",")," fourCorners",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Oval")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"createBox"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token maybe-class-name"},"Shapes"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},t.createElement(e.span,{className:"token maybe-class-name"},"Oval")),t.createElement(e.span,{className:"token punctuation"},",")," fourSides",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"Header")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"createBox"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token maybe-class-name"},"Shapes"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")),t.createElement(e.span,{className:"token punctuation"},",")," twoSides",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`,t.createElement(e.span,{className:"token keyword"},"let")," ",t.createElement(e.span,{className:"token maybe-class-name"},"TextBox")," ",t.createElement(e.span,{className:"token operator"},"=")," ",t.createElement(e.span,{className:"token function"},"createBox"),t.createElement(e.span,{className:"token punctuation"},"("),t.createElement(e.span,{className:"token maybe-class-name"},"Shapes"),t.createElement(e.span,{className:"token punctuation"},"."),t.createElement(e.span,{className:"token property-access"},t.createElement(e.span,{className:"token maybe-class-name"},"Rectangle")),t.createElement(e.span,{className:"token punctuation"},",")," fourCorners",t.createElement(e.span,{className:"token punctuation"},")"),t.createElement(e.span,{className:"token punctuation"},";"),`
`)),`
`,t.createElement(e.p,null,"The code is half the total size, and the duplication is gone completely! So ",t.createElement(e.em,null,"clean"),". If we want to change the behavior for a particular direction or a shape, we could do it in a single place instead of updating methods all over the place."),`
`,t.createElement(e.p,null,"It was already late at night (I got carried away). I checked in my refactoring to master and went to bed, proud of how I untangled my colleague's messy code."),`
`,t.createElement(e.h2,{id:"the-next-morning"},t.createElement(e.a,{className:"header-anchor",href:"#the-next-morning"},"#"),"The Next Morning"),`
`,t.createElement(e.p,null,"... did not go as expected."),`
`,t.createElement(e.p,null,"My boss invited me for a one-on-one chat where they politely asked me to revert my change. I was aghast. The old code was a mess, and mine was ",t.createElement(e.em,null,"clean"),"!"),`
`,t.createElement(e.p,null,"I begrudgingly complied, but it took me years to see they were right."),`
`,t.createElement(e.h2,{id:"its-a-phase"},t.createElement(e.a,{className:"header-anchor",href:"#its-a-phase"},"#"),"It\u2019s a Phase"),`
`,t.createElement(e.p,null,`Obsessing with "clean code" and removing duplication is a phase many of us go through. When we don't feel confident in our code, it is tempting to attach our sense of self-worth and professional pride to something that can be measured. A set of strict lint rules, a naming schema, a file structure, a lack of duplication.`),`
`,t.createElement(e.p,null,"You can't automate removing duplication, but it ",t.createElement(e.em,null,"does")," get easier with practice. You can usually tell whether there's less or more of it after every change. As a result, removing duplication feels like improving some objective metric about the code. Worse, it messes with people's sense of identity: ",t.createElement(e.em,null,`"I'm the kind of person who writes clean code"`),". It's as powerful as any sort of self-deception."),`
`,t.createElement(e.p,null,"Once we learn how to create ",t.createElement(e.a,{href:"https://www.sandimetz.com/blog/2016/1/20/the-wrong-abstraction"},"abstractions"),", it is tempting to get high on that ability, and pull abstractions out of thin air whenever we see repetitive code. After a few years of coding, we see repetition ",t.createElement(e.em,null,"everywhere")," -- and abstracting is our new superpower. If someone tells us that abstraction is a ",t.createElement(e.em,null,"virtue"),`, we'll eat it. And we'll start judging other people for not worshipping "cleanliness".`),`
`,t.createElement(e.p,null,'I see now that my "refactoring" was a disaster in two ways:'),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,"Firstly, I didn't talk to the person who wrote it. I rewrote the code and checked it in without their input. Even if it ",t.createElement(e.em,null,"was")," an improvement (which I don't believe anymore), this is a terrible way to go about it. A healthy engineering team is constantly ",t.createElement(e.em,null,"building trust"),". Rewriting your teammate's code without a discussion is a huge blow to your ability to effectively collaborate on a codebase together."),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,'Secondly, nothing is free. My code traded the ability to change requirements for reduced duplication, and it was not a good trade. For example, we later needed many special cases and behaviors for different handles on different shapes. My abstraction would have to become several times more convoluted to afford that, whereas with the original "messy" version such changes stayed easy as cake.'),`
`),`
`),`
`,t.createElement(e.p,null,'Am I saying that you should write "dirty" code? No. I suggest to think deeply about what you mean when you say "clean" or "dirty". Do you get a feeling of revolt? Righteousness? Beauty? Elegance? How sure are you that you can name the concrete engineering outcomes corresponding to those qualities? How exactly do they affect the way the code is written and ',t.createElement(e.a,{href:"/optimized-for-change/"},"modified"),"?"),`
`,t.createElement(e.p,null,"I sure didn't think deeply about any of those things. I thought a lot about how the code ",t.createElement(e.em,null,"looked")," -- but not about how it ",t.createElement(e.em,null,"evolved")," with a team of squishy humans."),`
`,t.createElement(e.p,null,"Coding is a journey. Think how far you came from your first line of code to where you are now. I reckon it was a joy to see for the first time how extracting a function or refactoring a class can make convoluted code simple. If you find pride in your craft, it is tempting to pursue cleanliness in code. Do it for a while."),`
`,t.createElement(e.p,null,"But don't stop there. Don't be a clean code zealot. Clean code is not a goal. It's an attempt to make some sense out of the immense complexity of systems we're dealing with. It's a defense mechanism when you're not yet sure how a change would affect the codebase but you need guidance in a sea of unknowns."),`
`,t.createElement(e.p,null,"Let clean code guide you. ",t.createElement(e.strong,null,"Then let it go.")))}}function Y(n={}){const{wrapper:a}=n.components||{};return a?t.createElement(a,n,t.createElement(l)):l();function l(){const e=Object.assign({p:"p",a:"a",blockquote:"blockquote",strong:"strong",code:"code",em:"em",h2:"h2",ul:"ul",li:"li"},n.components);return t.createElement(t.Fragment,null,t.createElement(e.p,null,"My ",t.createElement(e.a,{href:"/what-is-javascript-made-of/"},"previous post")," included this paragraph:"),`
`,t.createElement(e.blockquote,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,t.createElement(e.code,null,"let")," vs ",t.createElement(e.code,null,"const")," vs ",t.createElement(e.code,null,"var")),": Usually you want ",t.createElement(e.code,null,"let"),". If you want to forbid assignment to this variable, you can use ",t.createElement(e.code,null,"const"),". (Some codebases and coworkers are pedantic and force you to use ",t.createElement(e.code,null,"const")," when there is only one assignment.)"),`
`),`
`,t.createElement(e.p,null,"This turned out to be very controversial, sparking conversations on Twitter and Reddit. It seems that the majority view (or at least, the most vocally expressed view) is that one should ",t.createElement(e.em,null,"use ",t.createElement(e.code,null,"const")," wherever possible,")," only falling back to ",t.createElement(e.code,null,"let")," where necessary, as can be enforced with the ",t.createElement(e.a,{href:"https://eslint.org/docs/rules/prefer-const"},t.createElement(e.code,null,"prefer-const"))," ESLint rule."),`
`,t.createElement(e.p,null,"In this post, I will briefly summarize some of the arguments and counter-arguments I've encountered, as well as my personal conclusion on this topic."),`
`,t.createElement(e.h2,{id:"why-prefer-const"},t.createElement(e.a,{className:"header-anchor",href:"#why-prefer-const"},"#"),"Why ",t.createElement(e.code,null,"prefer-const")),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"One Way to Do It"),": It is mental overhead to have to choose between ",t.createElement(e.code,null,"let")," and ",t.createElement(e.code,null,"const"),' every time. A rule like "always use ',t.createElement(e.code,null,"const"),' where it works" lets you stop thinking about it and can be enforced by a linter.'),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Reassignments May Cause Bugs"),": In a longer function, it can be easy to miss when a variable is reassigned. This may cause bugs. Particularly in closures, ",t.createElement(e.code,null,"const"),` gives you confidence you'll always "see" the same value.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Learning About Mutation"),": Folks new to JavaScript often get confused thinking ",t.createElement(e.code,null,"const")," implies immutability. However, one could argue that it's important to learn the difference between variable mutation and assignment anyway, and preferring ",t.createElement(e.code,null,"const")," forces you to confront this distinction early on."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Meaningless Assignments"),": Sometimes, an assignment doesn't make sense at all. For example, with React Hooks, the values you get from a Hook like ",t.createElement(e.code,null,"useState")," are more like parameters. They flow in one direction. Seeing an error on their assignment helps you learn earlier about the React data flow."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Performance Benefits"),": There are occasional claims that JavaScript engines could make code using ",t.createElement(e.code,null,"const")," run faster due to the knowledge the variable won't be reassigned."),`
`),`
`,t.createElement(e.h2,{id:"why-not-prefer-const"},t.createElement(e.a,{className:"header-anchor",href:"#why-not-prefer-const"},"#"),"Why Not ",t.createElement(e.code,null,"prefer-const")),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Loss of Intent"),": If we force ",t.createElement(e.code,null,"const")," everywhere it can work, we lose the ability to communicate whether it was ",t.createElement(e.em,null,"important")," for something to not be reassigned."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Confusion with Immutability"),": In every discussion about why you should prefer ",t.createElement(e.code,null,"const"),", someone always confuses with immutability. This is unsurprising, as both assignment and mutation use the same ",t.createElement(e.code,null,"="),` operator. In response, people are usually told that they should "just learn the language". However, the counter-argument is that if a feature that prevents mostly beginner mistakes is confusing to beginners, it isn't very helpful. And unfortunately, it doesn't help prevent mutation mistakes which span across modules and affect everyone.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Pressure to Avoid Redeclaring"),": A ",t.createElement(e.code,null,"const"),"-first codebase creates a pressure to not use ",t.createElement(e.code,null,"let")," for conditionally assigned variables. For example, you might write ",t.createElement(e.code,null,"const a = cond ? b : c")," instead of an ",t.createElement(e.code,null,"if")," condition, even if both ",t.createElement(e.code,null,"b")," and ",t.createElement(e.code,null,"c")," branches are convoluted and giving them explicit names is awkward."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Reassignments May Not Cause Bugs"),": There are three common cases when reassignments cause bugs: when the scope is very large (such as module scope or huge functions), when the value is a parameter (so it's unexpected that it would be equal to something other than what was passed), and when a variable is used in a nested function. However, in many codebases most variables won't satisfy either of those cases, and parameters can't be marked as constant at all."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"No Performance Benefits"),": It is my understanding that the engines are already aware of which variables are only assigned once -- even if you use ",t.createElement(e.code,null,"var")," or ",t.createElement(e.code,null,"let"),". If we insist on speculating, we could just as well speculate that extra checks can ",t.createElement(e.em,null,"create")," performance cost rather than reduce it. But really, engines are smart."),`
`),`
`,t.createElement(e.h2,{id:"my-conclusion"},t.createElement(e.a,{className:"header-anchor",href:"#my-conclusion"},"#"),"My Conclusion"),`
`,t.createElement(e.p,null,"I don't care."),`
`,t.createElement(e.p,null,"I would use whatever convention already exists in the codebase."),`
`,t.createElement(e.p,null,"If you care, use a linter that automates checking and fixing this so that changing ",t.createElement(e.code,null,"let")," to ",t.createElement(e.code,null,"const")," doesn't become a delay in code review."),`
`,t.createElement(e.p,null,"Finally, remember that linters exist to serve ",t.createElement(e.em,null,"you"),". If a linter rule annoys you and your team, delete it. It may not be worth it. Learn from your own mistakes."))}}function _(n={}){const{wrapper:a}=n.components||{};return a?t.createElement(a,n,t.createElement(l)):l();function l(){const e=Object.assign({p:"p",strong:"strong",em:"em",hr:"hr",ul:"ul",li:"li",code:"code",a:"a"},n.components);return t.createElement(t.Fragment,null,t.createElement(e.p,null,"During my first few years of using JavaScript, I felt like a fraud. Even though I could build websites with frameworks, something was missing. I dreaded JavaScript job interviews because I didn't have a solid grasp on fundamentals."),`
`,t.createElement(e.p,null,"Over the years, I've formed a mental model of JavaScript that gave me confidence. Here, I'm sharing a ",t.createElement(e.strong,null,"very compressed")," version of it. It's structured like a glossary, with each topic getting a few sentences."),`
`,t.createElement(e.p,null,"As you read through this post, try to mentally keep score about how ",t.createElement(e.em,null,"confident")," you feel about each topic. I won't judge you if quite a few of them are a miss! At the end of this post, there is something that might help in that case."),`
`,t.createElement(e.hr),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Value"),`: The concept of a value is a bit abstract. It's a "thing". A value to JavaScript is what a number is to math, or what a point is to geometry. When your program runs, its world is full of values. Numbers like `,t.createElement(e.code,null,"1"),", ",t.createElement(e.code,null,"2"),", and ",t.createElement(e.code,null,"420")," are values, but so are some other things, like this sentence: ",t.createElement(e.code,null,'"Cows go moo"'),". Not ",t.createElement(e.em,null,"everything")," is a value though. A number is a value, but an ",t.createElement(e.code,null,"if")," statement is not. We'll look at a few different kinds of values below."),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Type of Value"),': There are a few different "types" of values. For example, ',t.createElement(e.em,null,"numbers")," like ",t.createElement(e.code,null,"420"),", ",t.createElement(e.em,null,"strings")," like ",t.createElement(e.code,null,'"Cows go moo"'),", ",t.createElement(e.em,null,"objects"),", and a few other types. You can learn a type of some value by putting ",t.createElement(e.code,null,"typeof")," before it. For example, ",t.createElement(e.code,null,"console.log(typeof 2)")," prints ",t.createElement(e.code,null,'"number"'),"."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Primitive Values"),`: Some value types are "primitive". They include numbers, strings, and a few other types. One peculiar thing about primitive values is that you can't create more of them, or change them in any way. For example, every time you write `,t.createElement(e.code,null,"2"),", you get the ",t.createElement(e.em,null,"same")," value ",t.createElement(e.code,null,"2"),`. You can't "create" another `,t.createElement(e.code,null,"2")," in your program, or make the ",t.createElement(e.code,null,"2")," ",t.createElement(e.em,null,"value"),' "become" ',t.createElement(e.code,null,"3"),". This is also true for strings."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,t.createElement(e.code,null,"null")," and ",t.createElement(e.code,null,"undefined")),": These are two special values. They're special because there's a lot of things you can't do with them -- they often cause errors. Usually, ",t.createElement(e.code,null,"null")," represents that some value is missing intentionally, and ",t.createElement(e.code,null,"undefined")," represents that a value is missing unintentionally. However, when to use either is left to the programmer. They exist because sometimes it's better for an operation to fail than to proceed with a missing value."),`
`),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Equality"),`: Like "value", equality is a fundamental concept in JavaScript. We say two values are equal when they're... actually, I'd never say that. If two values are equal, it means they `,t.createElement(e.em,null,"are")," the same value. Not two different values, but one! For example, ",t.createElement(e.code,null,'"Cows go moo" === "Cows go moo"')," and ",t.createElement(e.code,null,"2 === 2")," because ",t.createElement(e.code,null,"2")," ",t.createElement(e.em,null,"is")," ",t.createElement(e.code,null,"2"),". Note we use ",t.createElement(e.em,null,"three")," equal signs to represent this concept of equality in JavaScript."),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Strict Equality"),": Same as above."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Referential Equality"),": Same as above."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Loose Equality"),": Oof, this one is different! Loose equality is when we use ",t.createElement(e.em,null,"two")," equal signs (",t.createElement(e.code,null,"=="),"). Things may be considered ",t.createElement(e.em,null,"loosely equal")," even if they refer to ",t.createElement(e.em,null,"different")," values that look similar (such as ",t.createElement(e.code,null,"2")," and ",t.createElement(e.code,null,'"2"'),"). It was added to JavaScript early on for convenience and has caused endless confusion ever since. This concept is not fundamental, but is a common source of mistakes. You can learn how it works on a rainy day, but many people try to avoid it."),`
`),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Literal"),": A literal is when you refer to a value by ",t.createElement(e.em,null,"literally")," writing it down in your program. For example, ",t.createElement(e.code,null,"2")," is a ",t.createElement(e.em,null,"number literal"),", and ",t.createElement(e.code,null,'"Banana"')," is a ",t.createElement(e.em,null,"string literal"),"."),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Variable"),": A variable lets you refer to some value using a name. For example, ",t.createElement(e.code,null,'let message = "Cows go moo"'),". Now you can write ",t.createElement(e.code,null,"message")," instead of repeating the same sentence every time in your code. You may later change ",t.createElement(e.code,null,"message")," to point to another value, like ",t.createElement(e.code,null,'message = "I am the walrus"'),". Note this doesn't change ",t.createElement(e.em,null,"the value itself"),", but only where the ",t.createElement(e.code,null,"message"),' points to, like a "wire". It pointed to ',t.createElement(e.code,null,'"Cows go moo"'),", and now it points to ",t.createElement(e.code,null,'"I am the walrus"'),"."),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Scope"),": It would suck if there could only be one ",t.createElement(e.code,null,"message")," variable in the whole program. Instead, when you define a variable, it becomes available in a ",t.createElement(e.em,null,"part"),' of your program. That part is called a "scope". There are rules about how scope works, but usually you can search for the closest ',t.createElement(e.code,null,"{")," and ",t.createElement(e.code,null,"}"),' braces around where you define the variable. That "block" of code is its scope.'),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Assignment"),": When we write ",t.createElement(e.code,null,'message = "I am the walrus"'),", we change the ",t.createElement(e.code,null,"message")," variable to point to ",t.createElement(e.code,null,'"I am the walrus"')," value. This is called an assignment, writing, or setting the variable."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,t.createElement(e.code,null,"let")," vs ",t.createElement(e.code,null,"const")," vs ",t.createElement(e.code,null,"var")),": Usually you want ",t.createElement(e.code,null,"let"),". If you want to forbid assignment to this variable, you can use ",t.createElement(e.code,null,"const"),". (Some codebases and coworkers are pedantic and force you to use ",t.createElement(e.code,null,"const")," when there is only one assignment.) Avoid ",t.createElement(e.code,null,"var")," if you can because its scoping rules are confusing."),`
`),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Object"),": An object is a special kind of value in JavaScript. The cool thing about objects is that they can have connections to other values. For example, a ",t.createElement(e.code,null,'{flavor: "vanilla"}')," object has a ",t.createElement(e.code,null,"flavor")," property that points to the ",t.createElement(e.code,null,'"vanilla"'),' value. Think of an object as "your own" value with "wires" from it.'),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Property"),': A property is like a "wire" sticking from an object and pointing to some value. It might remind you of a variable: it has a name (like ',t.createElement(e.code,null,"flavor"),") and points to a value (like ",t.createElement(e.code,null,'"vanilla"'),'). But unlike a variable, a property "lives" ',t.createElement(e.em,null,"in")," the object itself rather than in some place in your code (scope). A property is considered a part of the object -- but the value it points to is not."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Object Literal"),": An object literal is a way to create an object value by ",t.createElement(e.em,null,"literally")," writing it down in your program, like ",t.createElement(e.code,null,"{}")," or ",t.createElement(e.code,null,'{flavor: "vanilla"}'),". Inside ",t.createElement(e.code,null,"{}"),", we can have multiple ",t.createElement(e.code,null,"property: value"),' pairs separated by commas. This lets us set up where the property "wires" point to from our object.'),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Object Identity"),": We mentioned earlier that ",t.createElement(e.code,null,"2")," is ",t.createElement(e.em,null,"equal")," to ",t.createElement(e.code,null,"2")," (in other words, ",t.createElement(e.code,null,"2 === 2"),") because whenever we write ",t.createElement(e.code,null,"2"),', we "summon" the same value. But whenever we write ',t.createElement(e.code,null,"{}"),", we will always get a ",t.createElement(e.em,null,"different")," value! So ",t.createElement(e.code,null,"{}")," is ",t.createElement(e.em,null,"not equal")," to another ",t.createElement(e.code,null,"{}"),". Try this in console: ",t.createElement(e.code,null,"{} === {}")," (the result is false). When the computer meets ",t.createElement(e.code,null,"2")," in our code, it always gives us the same ",t.createElement(e.code,null,"2")," value. However, object literals are different: when a computer meets ",t.createElement(e.code,null,"{}"),", it ",t.createElement(e.em,null,"creates a new object, which is always a new value"),". So what is object identity? It's yet another term for equality, or same-ness of values. When we say \u201C",t.createElement(e.code,null,"a")," and ",t.createElement(e.code,null,"b"),' have the same identity", we mean \u201C',t.createElement(e.code,null,"a")," and ",t.createElement(e.code,null,"b")," point to the ",t.createElement(e.em,null,"same"),' value" (',t.createElement(e.code,null,"a === b"),"). When we say \u201C",t.createElement(e.code,null,"a")," and ",t.createElement(e.code,null,"b"),' have different identities", we mean \u201C',t.createElement(e.code,null,"a")," and ",t.createElement(e.code,null,"b")," point to ",t.createElement(e.em,null,"different"),' values" (',t.createElement(e.code,null,"a !== b"),")."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Dot Notation"),": When you want to read a property from an object or assign to it, you can use the dot (",t.createElement(e.code,null,"."),") notation. For example, if a variable ",t.createElement(e.code,null,"iceCream")," points to an object whose property ",t.createElement(e.code,null,"flavor")," points to ",t.createElement(e.code,null,'"chocolate"'),", writing ",t.createElement(e.code,null,"iceCream.flavor")," will give you ",t.createElement(e.code,null,'"chocolate"'),"."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Bracket Notation"),": Sometimes you don't know the name of the property you want to read in advance. For example, maybe sometimes you want to read ",t.createElement(e.code,null,"iceCream.flavor")," and sometimes you want to read ",t.createElement(e.code,null,"iceCream.taste"),". The bracket (",t.createElement(e.code,null,"[]"),") notation lets you read the property when ",t.createElement(e.em,null,"its name itself")," is a variable. For example, let's say that ",t.createElement(e.code,null,"let ourProperty = 'flavor'"),". Then ",t.createElement(e.code,null,"iceCream[ourProperty]")," will give us ",t.createElement(e.code,null,'"chocolate"'),". Curiously, we can use it when creating objects too: ",t.createElement(e.code,null,'{ [ourProperty]: "vanilla" }'),"."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Mutation"),": We say an object is ",t.createElement(e.em,null,"mutated")," when somebody changes its property to point to a different value. For example, if we declare ",t.createElement(e.code,null,'let iceCream = {flavor: "vanilla"}'),", we can later ",t.createElement(e.em,null,"mutate")," it with ",t.createElement(e.code,null,'iceCream.flavor = "chocolate"'),". Note that even if we used ",t.createElement(e.code,null,"const")," to declare ",t.createElement(e.code,null,"iceCream"),", we could still mutate ",t.createElement(e.code,null,"iceCream.flavor"),". This is because ",t.createElement(e.code,null,"const")," would only prevent assignments to the ",t.createElement(e.code,null,"iceCream")," ",t.createElement(e.em,null,"variable itself"),", but we mutated a ",t.createElement(e.em,null,"property")," (",t.createElement(e.code,null,"flavor"),") of the object it pointed to. Some people swore off using ",t.createElement(e.code,null,"const")," altogether because they find this too misleading."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Array"),": An array is an object that represents a list of stuff. When you write an ",t.createElement(e.em,null,"array literal")," like ",t.createElement(e.code,null,'["banana", "chocolate", "vanilla"]'),", you essentially create an object whose property called ",t.createElement(e.code,null,"0")," points to the ",t.createElement(e.code,null,'"banana"')," string value, property called ",t.createElement(e.code,null,"1")," points to the ",t.createElement(e.code,null,'"chocolate"')," value, and property called ",t.createElement(e.code,null,"2")," points to the ",t.createElement(e.code,null,'"vanilla"')," value. It would be annoying to write ",t.createElement(e.code,null,"{0: ..., 1: ..., 2: ...}")," which is why arrays are useful. There are also some built-in ways to operate on arrays, like ",t.createElement(e.code,null,"map"),", ",t.createElement(e.code,null,"filter"),", and ",t.createElement(e.code,null,"reduce"),". Don't despair if ",t.createElement(e.code,null,"reduce")," seems confusing -- it's confusing to everyone."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Prototype"),": What happens if we read a property that doesn't exist? For example, ",t.createElement(e.code,null,"iceCream.taste")," (but our property is called ",t.createElement(e.code,null,"flavor"),"). The simple answer is we'll get the special ",t.createElement(e.code,null,"undefined"),` value. The more nuanced answer is that most objects in JavaScript have a "prototype". You can think of a prototype as a "hidden" property on every object that determines "where to look next". So if there's no `,t.createElement(e.code,null,"taste")," property on ",t.createElement(e.code,null,"iceCream"),", JavaScript will look for a ",t.createElement(e.code,null,"taste")," property on its prototype, then on ",t.createElement(e.em,null,"that")," object's prototype, and so on, and will only give us ",t.createElement(e.code,null,"undefined"),' if it reaches the end of this "prototype chain" without finding ',t.createElement(e.code,null,".taste"),". You will rarely interact with this mechanism directly, but it explains why our ",t.createElement(e.code,null,"iceCream")," object has a ",t.createElement(e.code,null,"toString")," method that we never defined -- it comes from the prototype."),`
`),`
`),`
`,t.createElement(e.li,null,`
`,t.createElement(e.p,null,t.createElement(e.strong,null,"Function"),": A function is a special value with one purpose: it represents ",t.createElement(e.em,null,"some code in your program"),`. Functions are handy if you don't want to write the same code many times. "Calling" a function like `,t.createElement(e.code,null,"sayHi()")," tells the computer to run the code inside it and then go back to where it was in the program. There are many ways to define a function in JavaScript, with slight differences in what they do."),`
`,t.createElement(e.ul,null,`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Arguments (or Parameters)"),": Arguments let you pass some information to your function from the place you call it: ",t.createElement(e.code,null,'sayHi("Amelie")'),`. Inside the function, they act similar to variables. They're called either "arguments" or "parameters" depending on which side you're reading (function definition or function call). However, this distinction in terminology is pedantic, and in practice these two terms are used interchangeably.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Function Expression"),": Previously, we set a variable to a ",t.createElement(e.em,null,"string value"),", like ",t.createElement(e.code,null,'let message = "I am the walrus"'),". It turns out that we can also set a variable to a ",t.createElement(e.em,null,"function"),", like ",t.createElement(e.code,null,"let sayHi = function() { }"),". The thing after ",t.createElement(e.code,null,"=")," here is called a ",t.createElement(e.em,null,"function expression"),". It gives us a special value (a function) that represents our piece of code, so we can call it later if we want to."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Function Declaration"),": It gets tiring to write something like ",t.createElement(e.code,null,"let sayHi = function() { }")," every time, so we can use a shorter form instead: ",t.createElement(e.code,null,"function sayHi() { }"),". This is called a ",t.createElement(e.em,null,"function declaration"),". Instead of specifying the variable name on the left, we put it after the ",t.createElement(e.code,null,"function")," keyword. These two styles are mostly interchangeable."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Function Hoisting"),": Normally, you can only use a variable after its declaration with ",t.createElement(e.code,null,"let")," or ",t.createElement(e.code,null,"const")," has run. This can be annoying with functions because they may need to call each other, and it's hard to track which function is used by which others and needs to be defined first. As a convenience, when (and only when!) you use the ",t.createElement(e.em,null,"function declaration"),` syntax, the order of their definitions doesn't matter because they get "hoisted". This is a fancy way of saying that conceptually, they all automatically get moved to the top of the scope. By the time you call them, they're all defined.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,t.createElement(e.code,null,"this")),": Probably the most misunderstood JavaScript concept, ",t.createElement(e.code,null,"this")," is like a special argument to a function. You don't pass it to a function yourself. Instead, JavaScript itself passes it, depending on ",t.createElement(e.em,null,"how you call")," the function. For example, calls using the dot ",t.createElement(e.code,null,".")," notation -- like ",t.createElement(e.code,null,"iceCream.eat()")," -- will get a special ",t.createElement(e.code,null,"this")," value from whatever is before the ",t.createElement(e.code,null,".")," (in our example, ",t.createElement(e.code,null,"iceCream"),"). The value of ",t.createElement(e.code,null,"this")," inside a function depends on how the function is ",t.createElement(e.em,null,"called"),", not where it's defined. Helpers like ",t.createElement(e.code,null,".bind"),", ",t.createElement(e.code,null,".call"),", and ",t.createElement(e.code,null,".apply")," let you have for more control over the value of ",t.createElement(e.code,null,"this"),"."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Arrow Functions"),": Arrow functions are similar to function expressions. You declare them like this: ",t.createElement(e.code,null,"let sayHi = () => { }"),". They're concise and are often used for one-liners. Arrow functions are ",t.createElement(e.em,null,"more limited")," than regular functions -- for example, they have no concept of ",t.createElement(e.code,null,"this")," whatsoever. When you write ",t.createElement(e.code,null,"this")," inside of an arrow function, it uses ",t.createElement(e.code,null,"this"),' of the closest "regular" function above. This is similar to what would happen if you used an argument or a variable that only exists in a function above. Practically, this means that people use arrow functions when they want to "see" the same ',t.createElement(e.code,null,"this")," inside of them as in the code surrounding them."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Function Binding"),": Usually, ",t.createElement(e.em,null,"binding")," a function ",t.createElement(e.code,null,"f")," to a particular ",t.createElement(e.code,null,"this")," value and arguments means creating a ",t.createElement(e.em,null,"new")," function that calls ",t.createElement(e.code,null,"f")," with those predefined values. JavaScript has a built-in helper to do it called ",t.createElement(e.code,null,".bind"),', but you could also do it by hand. Binding was a popular way to make nested functions "see" the same value of ',t.createElement(e.code,null,"this")," as the outer functions. But now this use case is handled by arrow functions, so binding is not used as often."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Call Stack"),": Calling a function is like entering a room. Every time we call a function, the variables inside of it are initialized all over again. So each function call is like ",t.createElement(e.em,null,"constructing"),` a new "room" with its code and entering it. Our function's variables "live" in that room. When we return from the function, that "room" disappears with all its variables. You can visualize these rooms as a vertical stack of rooms -- a `,t.createElement(e.em,null,"call stack"),'. When we exit a function, we go back to the function "below" it on the call stack.'),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Recursion"),": Recursion means that a function calls itself from within itself. This is useful for when you want to repeat the thing you just did in your function ",t.createElement(e.em,null,"again"),", but for different arguments. For example, if you're writing a search engine that crawls the web, your ",t.createElement(e.code,null,"collectLinks(url)")," function might first collect the links from a page, and then ",t.createElement(e.em,null,"call itself")," for every ",t.createElement(e.em,null,"link"),` until it visits all pages. The pitfall with recursion is that it's easy to write code that never finishes because a function keeps calling itself forever. If this happens, JavaScript will stop it with an error called "stack overflow". It's called this way because it means we have too many function calls stacked in our call stack, and it has literally overflown.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Higher-Order Function"),": A higher-order function is a function that deals with other functions by taking them as arguments or returning them. This might seem weird at first, but we should remember that functions are values so we can pass them around -- like we do with numbers, strings, or objects. This style can be overused, but it's very expressive in moderation."),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Callback"),": A callback is not really a JavaScript term. It's more of a pattern. It's when you pass a function as an argument to another function, expecting it to ",t.createElement(e.em,null,"call your function back later"),`. You're expecting a "call back". For example, `,t.createElement(e.code,null,"setTimeout")," takes a ",t.createElement(e.em,null,"callback"),` function and... calls you back after a timeout. But there's nothing special about callback functions. They're regular functions, and when we say "callback" we only talk about our expectations.`),`
`,t.createElement(e.li,null,t.createElement(e.strong,null,"Closure"),': Normally, when you exit a function, all its variables "disappear". This is because nothing needs them anymore. But what if you declare a function ',t.createElement(e.em,null,"inside")," a function? Then the inner function could still be called later, and read the variables of the ",t.createElement(e.em,null,"outer"),` function. In practice, this is very useful! But for this to work, the outer function's variables need to "stick around" somewhere. So in this case, JavaScript takes care of "keeping the variables alive" instead of "forgetting" them as it would usually do. This is called a "closure". While closures are often considered a misunderstood JavaScript aspect, you probably use them many times a day without realizing it!`),`
`),`
`),`
`),`
`,t.createElement(e.hr),`
`,t.createElement(e.p,null,"JavaScript is made of these concepts, and more. I felt very anxious about my knowledge of JavaScript until I could build a correct mental model, and I'd like to help the next generation of developers bridge this gap sooner."),`
`,t.createElement(e.p,null,"If you want to join me for a deeper dive in each of these topics, I have something for you. ",t.createElement(e.strong,null,t.createElement(e.a,{href:"https://justjavascript.com/"},"Just JavaScript")," is my distilled mental model of how JavaScript works, and it's going to feature visual illustrations by the amazing ",t.createElement(e.a,{href:"https://illustrated.dev/"},"Maggie Appleton")),". Unlike this post, it goes at a slower pace so you can follow along on every detail."),`
`,t.createElement(e.p,null,t.createElement(e.em,null,"Just JavaScript")," is in a very early stage so it's only available as a series of emails with zero polish or editing. If this project sounds interesting, you can ",t.createElement(e.a,{href:"https://justjavascript.com/"},"sign up")," to receive free drafts by email. I will be grateful for your feedback. Thank you!"))}}var X=[{component:J,filepath:"/home/runner/work/tianwenh.github.io/tianwenh.github.io/pages/before-you-memo/index.md",slug:"before-you-memo",frontmatter:{title:"Before You memo()",date:"2021-02-23T00:00:00.000Z",subtitle:"Rendering optimizations that come naturally.",tags:["react","js","test","tech","game","design","ux","hello","macbook","mouse"],only:!1,hide:!1}},{component:W,filepath:"/home/runner/work/tianwenh.github.io/tianwenh.github.io/pages/goodbye-clean-code/index.md",slug:"goodbye-clean-code",frontmatter:{title:"Goodbye, Clean Code",date:"2020-01-11T00:00:00.000Z",subtitle:"Let clean code guide you. Then let it go.",tags:["code","js"],only:!1,hide:!1}},{component:Y,filepath:"/home/runner/work/tianwenh.github.io/tianwenh.github.io/pages/on-let-vs-const/index.md",slug:"on-let-vs-const",frontmatter:{title:"On let vs const",date:"2019-12-22T00:00:00.000Z",subtitle:"So which one should I use?",tags:["js"],only:!1,hide:!1}},{component:_,filepath:"/home/runner/work/tianwenh.github.io/tianwenh.github.io/pages/what-is-javascript-made-of/index.md",slug:"what-is-javascript-made-of",frontmatter:{title:"What Is JavaScript Made Of?",date:"2019-12-20T00:00:00.000Z",subtitle:"Getting a closure on JavaScript.",tags:["js"],only:!1,hide:!1}}];function w(n){return n.toLowerCase().trim().replace(/[^\w\s-]/g,"-").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}function U(n){return Object.entries(n).filter(([,l])=>l).map(([l])=>l).join(" ")}const $=()=>{var l;const n=window.matchMedia("(prefers-color-scheme: dark)"),a=(l=v())!=null?l:n.matches?"dark":"light";b(a),requestAnimationFrame(()=>{document.body.style.transition="color 0.5s ease-out, background 0.5s ease-out"})},v=()=>localStorage.getItem("theme"),b=n=>{n==="dark"?document.documentElement.className="dark":document.documentElement.className="",localStorage.setItem("theme",n)},h=X.sort((n,a)=>new Date(a.frontmatter.date).getTime()-new Date(n.frontmatter.date).getTime()),x=h.reduce((n,a)=>(a.frontmatter.tags.forEach(l=>{var e;n[l]=[...(e=n[l])!=null?e:[],a]}),n),{}),V=Object.entries(x).reduce((n,[a,l])=>{var c;const e=w(a);return n[e]=[...(c=n[e])!=null?c:[],...l],n},{}),Z=Object.keys(x);const s=d.exports.jsx,r=d.exports.jsxs,u=d.exports.Fragment,Q=()=>r("div",{className:"layout-container",children:[s("header",{className:"layout-head",children:r("h3",{children:[s(k,{to:"/",children:"HTW"}),s(K,{})]})}),s("main",{children:s(H,{})})]});function G(){return typeof window=="undefined"?!1:v()==="dark"}const K=()=>{const n=e=>e?"dark":"light",[a,l]=i.exports.useState(G());return i.exports.useEffect(()=>{b(n(a))},[a]),s("span",{className:"dark-toggle",onClick:()=>l(!a),children:a?"\u{1F318}":"\u{1F314}"})},T=n=>{const a=w(n.tag);return r(M,{to:`/tags/${a}`,className:({isActive:l})=>{var e;return U({[(e=n.className)!=null?e:""]:!0,"tag-active":l})},children:["#",n.tag]})},I=n=>{const a=new Date(n.page.frontmatter.date).toLocaleDateString();return r(u,{children:[s("h2",{className:"page-title",children:s(k,{to:`/${n.page.slug}`,children:n.page.frontmatter.title})}),s("p",{className:"page-subtitle",children:n.page.frontmatter.subtitle}),r("small",{children:[s("time",{dateTime:a,className:"page-info",children:a}),n.page.frontmatter.tags.map(l=>s(T,{tag:l,className:"page-info"},l))]})]})},ee=n=>{if(/^https?:\/\//.test(n.href))return s("a",E({target:"_blank"},n));const l=n.href.replace(/\.mdx?/,"");return s(k,g(E({},n),{to:l}))},te={a:ee},ne=n=>r(u,{children:[s("header",{children:s(I,{page:n.page})}),s("hr",{}),s(n.page.component,{components:te}),s("hr",{}),s("footer",{children:"EOF"})]}),j=n=>s(u,{children:n.pages.map(a=>s("article",{className:"card pages-card",children:s(I,{page:a})},a.slug))}),ae=n=>{const a=n&&V[n];return!a||a.length===0?s("div",{children:"No pages..."}):s(j,{pages:a})},S=()=>{const{tagSlug:n}=L();return r(u,{children:[s("section",{className:"tags",children:Z.map(a=>s(T,{tag:a,className:"card tag-card"},a))}),s("hr",{}),ae(n)]})};function le(){return se(),ce(),s(O,{children:r(m,{path:"/",element:s(Q,{}),children:[s(m,{index:!0,element:s(j,{pages:h})}),s(m,{path:"/tags",element:s(S,{})}),s(m,{path:"/tags/:tagSlug",element:s(S,{})}),h.map(n=>s(m,{path:`/${n.slug}`,element:s(ne,{page:n})},n.slug)),s(m,{path:"*",element:s(R,{to:"/"})})]})})}function se(){const{pathname:n}=y();i.exports.useEffect(()=>{window.scrollTo(0,0)},[n])}function ce(){const{hash:n}=y();i.exports.useEffect(()=>{const a=document.getElementById(n.slice(1));a==null||a.scrollIntoView({behavior:"smooth"})},[])}$();const oe=P.hydrate;oe(s(t.StrictMode,{children:s(q,{children:s(le,{})})}),document.getElementById("app"));
